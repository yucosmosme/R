---
title: "markdown"
author: "minah"
date: '2019 11 21 '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### 분석사례 (p.78)

(1) 자료 파일 읽기
```{r}
library(readxl)
chemical <-read_excel("D:\\Workspace\\RegressionModel\\RegressionModel_Assignment\\p78.xlsx",1)
head(chemical)
```
head 함수를 통하여 데이터 값의 처음 6줄을 보여준다.



(2) 기술 통계량 및 상관계수 보기
```{r}
summary(chemical[,-1])
cor(chemical[,-1])
```
cor 명령을 통해 독립변수들(속도, 온도)과 종속변수(손실량) 간의 상관관계가 각각 0.8548423, 0.8953498로 높음을 알 수 있다. 



(3) 회귀모형 적합하기
```{r}
chemical.lm=lm(LOSS~SPEED+TEMP, data=chemical)
summary(chemical.lm)
```
summary 함수를 통하여 추정된 회귀방정식은 y^=-47.6243 + 0.4216*speed + 1.9217*temp 이다.

결정계수 R-square = 0.8539로서, 중회귀모형이 종속변수 loss의 총변동을 85.4%정도 설명하고 있음을 나타낸다.

표준오차 root MSE=4.465 로서,  σ의 추정치가 4.465임을 알 수 있다. 

speed에 대한 유의확률 p-값은 0.106360으로 유의수준 0.05에서 loss에 대한 설명력이 약하다고 할 수 있으며,

temp에 대한 유의확률 p-값은 0.022316으로 유의수준 0.05의 범위내에 있으므로, loss에 대한 설명력이 높다고 할 수 있다. 


```{r}
par("mar")
par(mar=c(1,1,1,1))
library(car)
library(carData)
avPlots(chemical.lm)
```

speed에 대한 추가변수그림을 보면 선형성이 낮으므로, speed 변수는 회귀모형에서 유의성이 떨어진다고 볼 수 있으며,
temp에 대한 추가변수 그림은 선형성이 높으므로 temp 변수의 유의성은 높음을 알 수 있다. 




(4) 분산분석표
```{r pressure, echo=FALSE}
anova(chemical.lm)
```

summary함수에서 본 F-statistics=26.3에 대한 p-value=0.0001741 로 매우 작으므로, 본 중회귀모형이 매우 유의함을 알 수 있다. 
또한 오차분산의 추정치 MSE=19.94임을 알 수 있다. 




(5) 잔차산점도 그리기
```{r}
plot(chemical$SPEED, chemical.lm$residuals)
identify(chemical$SPEED, chemical.lm$residuals)

plot(chemical$TEMP, chemical.lm$residuals)
identify(chemical$TEMP, chemical.lm$residuals)
```
잔차산점도를 보면 speed, temp 변수 모두 12번째 데이터가 떨어져있어 특이점으로 보이며, 그를 제외하면 아래로 볼록한 2차곡선의 모양을 갖는 것처럼 보인다. 

```{r}
plot(chemical.lm$fitted.values, chemical.lm$residuals)
abline(h=0, lty=2)
identify(chemical.lm$fitted.values, chemical.lm$residuals)

```
Y(loss)추정값과 잔차의 산점도를 보면 12번째 데이터를 제외하면 어떤 뚜렷한 현상은 나타나지 않고 있다. 
12번째케이스에 대한 조사를 거쳐 특이점으로 판명되면 이 케이스를 제외하고 분석이 필요할 것으로 보인다. 

